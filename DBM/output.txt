logits: tensor([[-0.0860,  0.5614, -1.7388,  ..., -0.1722, -1.6481, -1.5797],
        [ 0.3111,  0.5189, -0.8784,  ..., -0.2020, -0.5843, -0.5687],
        [ 0.0868,  0.5659, -0.5557,  ..., -0.1046, -0.3685, -0.4802],
        ...,
        [ 0.0869,  0.6589, -1.0956,  ..., -0.1050, -0.5373, -0.7745],
        [-0.0232,  0.5563, -0.8083,  ..., -0.1217, -0.5094, -0.4418],
        [ 0.0640,  0.5409, -0.8999,  ..., -0.1112, -0.5956, -0.4511]],
       device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([0, 5, 4, 4, 9, 3, 9, 9, 3, 3, 0, 7, 0, 5, 5, 4, 1, 1, 6, 1, 6, 5, 8, 3,
        1, 6, 4, 2, 4, 2, 3, 7, 1, 3, 3, 8, 7, 0, 0, 0, 9, 0, 6, 7, 8, 4, 2, 0,
        3, 5, 2, 9, 5, 3, 4, 5, 5, 6, 7, 6, 8, 4, 0, 9, 0, 6, 7, 6, 9, 5, 2, 5,
        6, 9, 4, 9, 6, 1, 2, 6, 6, 2, 9, 5, 1, 1, 3, 5, 6, 5, 9, 3, 1, 1, 4, 8,
        7, 9, 5, 9, 6, 8, 7, 7, 5, 0, 5, 4, 7, 3, 2, 6, 7, 8, 2, 0, 3, 5, 7, 2,
        0, 2, 2, 0, 3, 3, 8, 1], device='cuda:0'), scale: 1.0, loss: 2.4433133602142334, grad: 0.2591850757598877
i: 0 penalty_anneal_iters 190 loss: 9.604888916015625, penalty_weight: 1.0, train_penalty: 0.06717690080404282
Training epoch 0: [1|391], loss:9.604888916015625, accuracy:8.59375
logits: tensor([[ 0.8992, -4.6713,  1.8786,  ...,  0.4222,  0.5605,  2.0987],
        [ 0.0117, -5.0127,  1.7740,  ...,  0.7292,  0.1770,  1.5962],
        [-0.1615, -5.1160,  1.6253,  ...,  0.4005,  0.3524,  1.3137],
        ...,
        [ 0.1381, -4.7577,  1.9067,  ...,  0.4327,  0.4234,  2.0397],
        [ 6.5734, -6.6738,  7.1815,  ...,  4.1610,  1.9134,  7.1211],
        [ 2.6633, -5.4700,  3.6905,  ...,  2.3265,  0.7906,  3.9396]],
       device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([9, 1, 8, 9, 1, 5, 0, 2, 5, 2, 7, 7, 7, 2, 4, 3, 7, 6, 7, 1, 0, 8, 5, 1,
        0, 8, 3, 7, 2, 4, 5, 5, 7, 1, 7, 3, 1, 4, 2, 3, 1, 5, 3, 8, 6, 5, 5, 5,
        4, 7, 1, 3, 3, 0, 3, 3, 2, 6, 5, 3, 4, 2, 8, 7, 7, 4, 6, 6, 2, 4, 7, 9,
        7, 2, 5, 1, 0, 9, 4, 1, 7, 9, 8, 1, 6, 5, 0, 9, 4, 3, 0, 6, 7, 8, 1, 0,
        0, 3, 0, 2, 5, 7, 9, 7, 6, 8, 0, 1, 3, 1, 1, 8, 9, 5, 4, 2, 8, 6, 9, 0,
        3, 3, 4, 7, 2, 9, 4, 0], device='cuda:0'), scale: 1.0, loss: 4.290531158447266, grad: 2.8107798099517822
i: 1 penalty_anneal_iters 190 loss: 19.282939910888672, penalty_weight: 1.0, train_penalty: 7.900483131408691
logits: tensor([[  11.3942,   10.5501,  -39.1605,  ...,   26.3008,   13.9192,
          -25.8625],
        [  63.0789,   56.4241, -221.0739,  ...,  151.8163,   67.0947,
         -142.6554],
        [  11.7548,   10.2246,  -39.8593,  ...,   26.8058,   14.0695,
          -26.2054],
        ...,
        [  13.8666,   12.8810,  -49.5471,  ...,   34.0912,   16.0209,
          -32.8201],
        [  19.2945,   17.8115,  -68.5733,  ...,   47.4165,   21.7206,
          -44.8269],
        [  11.2981,   10.6179,  -39.8259,  ...,   27.0460,   13.5493,
          -26.3257]], device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([3, 2, 1, 6, 1, 8, 3, 0, 1, 8, 5, 5, 2, 1, 3, 5, 3, 3, 9, 3, 2, 4, 1, 8,
        7, 0, 9, 6, 9, 2, 7, 6, 4, 5, 3, 4, 4, 5, 7, 4, 2, 2, 1, 0, 8, 4, 3, 4,
        4, 7, 4, 5, 4, 6, 8, 3, 2, 6, 3, 3, 3, 1, 2, 2, 2, 7, 7, 1, 7, 5, 5, 9,
        8, 9, 9, 4, 9, 0, 3, 1, 8, 3, 0, 3, 6, 2, 7, 2, 3, 6, 7, 5, 9, 1, 3, 1,
        9, 1, 6, 6, 3, 2, 6, 2, 3, 6, 9, 6, 9, 7, 3, 6, 6, 1, 8, 1, 9, 5, 1, 1,
        7, 2, 4, 9, 9, 3, 8, 0], device='cuda:0'), scale: 1.0, loss: 39.52788162231445, grad: 39.52348327636719
i: 2 penalty_anneal_iters 190 loss: 1608.80908203125, penalty_weight: 1.0, train_penalty: 1562.105712890625
logits: tensor([[ 1.7982e+00,  4.1614e+00,  3.0581e+00,  ..., -2.7710e+01,
          2.9060e+00,  3.0455e+00],
        [ 6.1161e-01,  1.4588e+00,  9.3102e-01,  ..., -9.3590e+00,
          9.8667e-01,  9.9910e-01],
        [ 6.1198e-01,  1.4599e+00,  9.3107e-01,  ..., -9.3630e+00,
          9.8648e-01,  9.9889e-01],
        ...,
        [ 8.8300e+01,  2.0218e+02,  1.5517e+02,  ..., -1.4082e+03,
          1.5120e+02,  1.6138e+02],
        [ 7.1967e-01,  1.7097e+00,  1.1045e+00,  ..., -1.1112e+01,
          1.1691e+00,  1.1655e+00],
        [ 6.1426e-01,  1.4638e+00,  9.3495e-01,  ..., -9.3924e+00,
          9.9095e-01,  1.0045e+00]], device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([5, 5, 9, 1, 7, 4, 7, 1, 5, 8, 1, 1, 3, 0, 3, 6, 8, 4, 9, 6, 4, 8, 7, 5,
        9, 1, 4, 7, 2, 0, 3, 0, 1, 0, 2, 4, 8, 4, 7, 4, 5, 0, 8, 5, 0, 6, 7, 7,
        9, 4, 0, 3, 7, 1, 5, 1, 6, 3, 1, 1, 0, 7, 1, 7, 7, 8, 3, 4, 4, 9, 1, 1,
        4, 3, 1, 1, 4, 2, 8, 3, 8, 5, 9, 0, 4, 7, 8, 0, 9, 9, 4, 1, 9, 3, 6, 6,
        9, 3, 2, 2, 4, 8, 0, 5, 0, 6, 5, 0, 2, 2, 6, 2, 4, 7, 5, 7, 0, 5, 4, 9,
        2, 7, 7, 2, 3, 5, 7, 6], device='cuda:0'), scale: 1.0, loss: 25.21149253845215, grad: 23.5274658203125
i: 3 penalty_anneal_iters 190 loss: 813.8609619140625, penalty_weight: 1.0, train_penalty: 553.5416259765625
logits: tensor([[  1.2732,   1.9920,   1.5518,  ..., -13.0838,   1.3946,   1.5242],
        [  1.2732,   1.9920,   1.5518,  ..., -13.0838,   1.3946,   1.5242],
        [  1.2732,   1.9920,   1.5518,  ..., -13.0838,   1.3946,   1.5242],
        ...,
        [  1.2732,   1.9920,   1.5518,  ..., -13.0838,   1.3946,   1.5242],
        [  1.2732,   1.9920,   1.5518,  ..., -13.0838,   1.3946,   1.5242],
        [  1.2732,   1.9920,   1.5518,  ..., -13.0838,   1.3946,   1.5242]],
       device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([7, 4, 9, 9, 4, 3, 0, 3, 5, 6, 4, 6, 7, 1, 4, 1, 0, 9, 6, 6, 4, 1, 7, 5,
        6, 8, 0, 6, 4, 8, 1, 1, 0, 3, 6, 8, 4, 4, 2, 5, 3, 9, 6, 0, 8, 9, 4, 4,
        7, 6, 7, 2, 3, 7, 2, 3, 1, 2, 1, 2, 3, 6, 5, 5, 5, 4, 5, 6, 1, 8, 8, 5,
        1, 2, 8, 8, 6, 3, 6, 2, 8, 2, 8, 1, 1, 5, 4, 7, 8, 7, 0, 2, 1, 6, 1, 8,
        6, 3, 2, 8, 2, 3, 5, 8, 5, 6, 7, 8, 2, 9, 1, 3, 8, 3, 3, 2, 1, 1, 5, 7,
        2, 5, 1, 0, 1, 9, 7, 6], device='cuda:0'), scale: 1.0, loss: 3.806022882461548, grad: 1.7371681928634644
i: 4 penalty_anneal_iters 190 loss: 840.2103881835938, penalty_weight: 1.0, train_penalty: 3.0177533626556396
logits: tensor([[  2.0103,   2.7067,   2.3500,  ..., -18.3445,   2.0252,   2.2671],
        [  2.0103,   2.7067,   2.3500,  ..., -18.3445,   2.0252,   2.2671],
        [  2.0103,   2.7067,   2.3500,  ..., -18.3445,   2.0252,   2.2671],
        ...,
        [  2.0103,   2.7067,   2.3500,  ..., -18.3445,   2.0252,   2.2671],
        [  2.0103,   2.7067,   2.3500,  ..., -18.3445,   2.0252,   2.2671],
        [  2.0103,   2.7067,   2.3500,  ..., -18.3445,   2.0252,   2.2671]],
       device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([6, 7, 6, 3, 2, 2, 6, 0, 9, 8, 6, 6, 7, 1, 7, 2, 1, 4, 7, 8, 6, 4, 8, 5,
        4, 3, 4, 1, 9, 7, 7, 0, 9, 5, 2, 2, 2, 0, 2, 1, 4, 9, 9, 7, 6, 0, 1, 2,
        8, 6, 9, 0, 8, 1, 7, 7, 0, 4, 0, 7, 3, 2, 1, 6, 1, 1, 7, 1, 4, 9, 5, 0,
        7, 9, 7, 8, 2, 0, 6, 0, 8, 5, 0, 0, 5, 1, 5, 7, 0, 0, 2, 0, 4, 8, 7, 1,
        2, 4, 7, 4, 0, 9, 3, 5, 7, 7, 9, 1, 4, 9, 0, 3, 5, 9, 4, 4, 8, 1, 7, 1,
        3, 4, 5, 3, 4, 7, 4, 3], device='cuda:0'), scale: 1.0, loss: 6.865946292877197, grad: 4.871618747711182
i: 5 penalty_anneal_iters 190 loss: 1722.4185791015625, penalty_weight: 1.0, train_penalty: 23.732669830322266
logits: tensor([[  3.0882,   3.6412,   3.6404,  ..., -26.5241,   3.1343,   3.6095],
        [  3.0862,   3.6388,   3.6367,  ..., -26.5017,   3.1310,   3.6051],
        [  3.0878,   3.6408,   3.6397,  ..., -26.5198,   3.1337,   3.6087],
        ...,
        [  3.0916,   3.6453,   3.6465,  ..., -26.5617,   3.1397,   3.6169],
        [  3.1096,   3.6667,   3.6788,  ..., -26.7606,   3.1685,   3.6562],
        [  3.0831,   3.6351,   3.6312,  ..., -26.4675,   3.1261,   3.5984]],
       device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([4, 6, 9, 7, 6, 0, 4, 6, 0, 3, 8, 3, 9, 2, 0, 7, 0, 8, 9, 4, 1, 8, 0, 2,
        2, 4, 7, 9, 5, 4, 9, 6, 9, 9, 7, 3, 9, 9, 3, 2, 8, 8, 9, 7, 4, 2, 0, 3,
        1, 8, 5, 4, 6, 5, 3, 6, 5, 1, 9, 3, 7, 1, 3, 6, 3, 1, 0, 8, 3, 6, 6, 4,
        6, 1, 4, 0, 5, 7, 2, 9, 7, 9, 9, 2, 2, 8, 4, 2, 8, 8, 5, 3, 1, 8, 5, 5,
        8, 3, 7, 8, 9, 0, 6, 5, 2, 3, 4, 5, 7, 0, 4, 1, 1, 0, 5, 4, 5, 0, 4, 1,
        5, 1, 5, 4, 2, 6, 7, 6], device='cuda:0'), scale: 1.0, loss: 50.64853286743164, grad: 48.66224670410156
i: 6 penalty_anneal_iters 190 loss: 5141.29638671875, penalty_weight: 1.0, train_penalty: 2368.01416015625
logits: tensor([[   41.0503,    53.1266,    75.9837,  ...,  -509.1587,    77.0129,
           106.7833],
        [   41.5809,    53.7720,    76.8373,  ...,  -515.1230,    77.9029,
           108.0938],
        [   43.6631,    56.4424,    80.5475,  ...,  -540.0690,    81.6570,
           113.5021],
        ...,
        [   41.4324,    53.6233,    76.6827,  ...,  -513.8041,    77.7132,
           107.7867],
        [   40.7260,    52.7046,    75.3924,  ...,  -505.1657,    76.4097,
           105.9184],
        [  144.9449,   195.7948,   252.9907,  ..., -1746.0122,   239.1342,
           324.4160]], device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([4, 3, 5, 9, 6, 5, 5, 6, 9, 8, 0, 5, 2, 8, 0, 6, 8, 0, 6, 7, 8, 1, 7, 0,
        4, 9, 5, 3, 7, 4, 0, 2, 5, 9, 7, 5, 8, 7, 1, 0, 8, 4, 3, 7, 7, 6, 8, 1,
        9, 3, 3, 5, 4, 7, 4, 5, 5, 8, 9, 9, 2, 4, 0, 2, 5, 6, 6, 8, 8, 9, 3, 8,
        9, 4, 8, 9, 5, 2, 9, 3, 2, 8, 3, 1, 8, 6, 4, 0, 3, 3, 3, 3, 8, 4, 7, 7,
        8, 9, 7, 5, 8, 7, 6, 5, 8, 3, 5, 4, 4, 9, 7, 4, 6, 9, 2, 6, 7, 0, 7, 1,
        2, 1, 2, 2, 5, 8, 8, 6], device='cuda:0'), scale: 1.0, loss: 135.10569763183594, grad: 135.1056671142578
i: 7 penalty_anneal_iters 190 loss: 22322.259765625, penalty_weight: 1.0, train_penalty: 18253.541015625
logits: tensor([[  35.2260,   38.6920,   68.8552,  ..., -410.1291,   71.2493,
            9.2670],
        [  47.7658,   56.1837,   98.4444,  ..., -586.8435,   92.4788,
           71.8276],
        [  35.4597,   39.6094,   69.9330,  ..., -416.2904,   71.0892,
           17.2080],
        ...,
        [  45.7788,   69.3976,   70.4370,  ..., -520.3955,   63.5092,
          -10.7978],
        [  40.2406,   45.3238,   80.4923,  ..., -479.3643,   80.5851,
           27.5403],
        [  40.4882,   46.5455,   80.5729,  ..., -485.9455,   82.7921,
           13.9034]], device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([7, 3, 4, 6, 4, 0, 9, 6, 8, 7, 6, 4, 4, 8, 2, 8, 3, 4, 6, 3, 2, 9, 1, 9,
        7, 5, 2, 7, 8, 5, 2, 1, 4, 8, 7, 9, 5, 6, 6, 6, 6, 0, 0, 6, 3, 2, 9, 0,
        6, 3, 1, 6, 2, 9, 6, 1, 6, 6, 7, 5, 4, 1, 2, 7, 1, 5, 0, 0, 7, 5, 4, 5,
        4, 5, 9, 7, 0, 6, 8, 9, 0, 9, 9, 4, 0, 0, 1, 2, 1, 9, 3, 7, 9, 2, 2, 7,
        5, 4, 4, 9, 4, 7, 1, 4, 8, 1, 1, 3, 9, 3, 9, 6, 6, 5, 0, 1, 1, 6, 2, 9,
        9, 4, 3, 2, 0, 0, 6, 4], device='cuda:0'), scale: 1.0, loss: 1015.9482421875, grad: 1015.7036743164062
i: 8 penalty_anneal_iters 190 loss: 1041081.0625, penalty_weight: 1.0, train_penalty: 1031653.9375
logits: tensor([[ 5.3529e+03,  2.6454e+04,  4.8775e+03,  ..., -2.4412e+04,
          6.2172e+03,  3.3680e+03],
        [ 2.2688e+04,  1.6809e+05,  1.9461e+04,  ...,  6.2732e+01,
          3.5373e+04, -9.8164e+04],
        [ 3.6833e+04,  3.2462e+05,  3.0388e+04,  ...,  3.1673e+04,
          5.7011e+04, -1.6535e+05],
        ...,
        [ 4.3421e+03,  2.9333e+04,  4.9414e+03,  ..., -1.7620e+04,
          6.7160e+03, -9.8290e+03],
        [ 3.2768e+03,  1.2842e+04,  3.3265e+03,  ..., -2.2020e+04,
          3.5477e+03,  7.0578e+03],
        [ 3.0214e+03,  1.6833e+04,  3.5883e+03,  ..., -1.8780e+04,
          4.1973e+03, -5.0353e+02]], device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([6, 5, 5, 3, 2, 7, 6, 4, 6, 3, 9, 1, 3, 7, 0, 8, 3, 6, 2, 0, 6, 3, 9, 5,
        5, 6, 1, 2, 3, 5, 0, 8, 8, 7, 0, 8, 0, 9, 7, 7, 8, 0, 1, 7, 2, 5, 0, 9,
        2, 3, 9, 9, 3, 6, 4, 5, 9, 4, 0, 0, 6, 2, 9, 5, 8, 7, 5, 9, 2, 5, 1, 4,
        9, 3, 5, 6, 6, 3, 6, 4, 8, 4, 2, 1, 5, 7, 4, 8, 7, 4, 6, 5, 7, 7, 9, 3,
        1, 0, 6, 0, 0, 8, 9, 6, 7, 9, 7, 7, 4, 6, 2, 1, 9, 2, 3, 7, 3, 5, 0, 8,
        9, 0, 7, 1, 5, 6, 4, 5], device='cuda:0'), scale: 1.0, loss: 553029.0625, grad: 553029.0
i: 9 penalty_anneal_iters 190 loss: 305845501952.0, penalty_weight: 1.0, train_penalty: 305841078272.0
logits: tensor([[3.2554e+11, 1.5904e+09, 5.9005e+10,  ..., 1.6130e+10, 1.3437e+12,
         1.9176e+11],
        [3.2550e+11, 1.5994e+09, 5.9116e+10,  ..., 1.6393e+10, 1.3456e+12,
         1.9250e+11],
        [3.2546e+11, 1.6330e+09, 5.9523e+10,  ..., 1.7340e+10, 1.3529e+12,
         1.9520e+11],
        ...,
        [3.3959e+11, 1.6080e+10, 8.2760e+10,  ..., 7.5377e+10, 1.4517e+12,
         2.8312e+11],
        [2.8194e+13, 8.9261e+12, 1.6387e+13,  ..., 2.6450e+13, 6.5683e+13,
         4.0344e+13],
        [6.7287e+14, 1.9354e+14, 3.6420e+14,  ..., 5.8341e+14, 1.5803e+15,
         8.9982e+14]], device='cuda:0', grad_fn=<AddmmBackward>), y: tensor([0, 3, 8, 7, 5, 5, 8, 9, 2, 8, 1, 7, 4, 3, 4, 8, 3, 6, 6, 8, 4, 8, 4, 1,
        3, 2, 1, 1, 8, 2, 8, 1, 0, 8, 0, 9, 6, 8, 4, 0, 8, 9, 0, 0, 0, 0, 9, 3,
        2, 1, 9, 0, 4, 0, 4, 3, 0, 6, 4, 4, 8, 8, 6, 3, 8, 9, 0, 5, 1, 9, 7, 8,
        9, 9, 3, 0, 8, 4, 9, 2, 2, 4, 0, 2, 6, 6, 7, 6, 6, 4, 5, 2, 2, 2, 2, 1,
        7, 2, 7, 5, 0, 6, 9, 1, 9, 9, 4, 5, 4, 1, 5, 1, 4, 7, 0, 7, 3, 9, 7, 3,
        5, 7, 4, 6, 2, 1, 8, 1], device='cuda:0'), scale: 1.0, loss: 51658448961536.0, grad: 51658448961536.0
i: 10 penalty_anneal_iters 190 loss: 2.668595427518093e+27, penalty_weight: 1.0, train_penalty: 2.668595427518093e+27
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([2, 7, 2, 0, 7, 7, 7, 1, 3, 9, 5, 6, 4, 1, 9, 9, 1, 3, 4, 9, 9, 8, 8, 2,
        7, 5, 5, 5, 4, 7, 2, 8, 3, 7, 1, 0, 5, 5, 5, 1, 7, 2, 8, 2, 5, 7, 3, 1,
        4, 6, 3, 1, 2, 4, 8, 8, 1, 4, 5, 7, 8, 7, 6, 1, 6, 7, 2, 4, 7, 6, 7, 5,
        7, 2, 3, 7, 1, 4, 7, 9, 8, 9, 9, 5, 0, 7, 8, 6, 0, 5, 0, 4, 2, 9, 7, 1,
        7, 8, 1, 1, 5, 6, 5, 2, 6, 3, 4, 2, 7, 5, 1, 4, 5, 2, 9, 7, 4, 2, 8, 8,
        9, 5, 1, 5, 8, 4, 7, 7], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 11 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([7, 8, 2, 0, 8, 4, 6, 2, 4, 8, 1, 6, 0, 8, 2, 9, 1, 5, 6, 1, 0, 0, 9, 6,
        7, 9, 7, 7, 9, 8, 7, 6, 1, 0, 8, 8, 7, 5, 5, 9, 4, 3, 6, 3, 9, 7, 1, 5,
        6, 9, 2, 0, 0, 6, 0, 9, 2, 6, 5, 2, 7, 5, 9, 6, 4, 1, 0, 4, 4, 3, 9, 8,
        7, 9, 0, 6, 7, 1, 7, 9, 7, 4, 6, 3, 3, 4, 3, 6, 8, 5, 8, 9, 9, 8, 1, 9,
        0, 4, 7, 1, 2, 4, 9, 9, 3, 0, 4, 4, 9, 7, 6, 6, 1, 6, 4, 5, 9, 4, 9, 2,
        5, 1, 4, 6, 3, 5, 4, 4], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 12 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([2, 0, 6, 8, 5, 2, 4, 0, 5, 3, 7, 1, 7, 1, 1, 3, 6, 7, 8, 7, 8, 0, 5, 1,
        2, 3, 6, 1, 2, 5, 7, 4, 7, 7, 7, 6, 4, 4, 8, 2, 9, 5, 7, 6, 9, 0, 4, 2,
        6, 2, 4, 0, 3, 4, 9, 3, 0, 7, 8, 2, 3, 8, 3, 1, 3, 5, 3, 5, 4, 2, 9, 7,
        3, 4, 0, 9, 8, 9, 2, 1, 3, 0, 2, 8, 1, 1, 7, 3, 0, 3, 4, 4, 5, 7, 7, 9,
        0, 0, 3, 8, 1, 5, 7, 0, 8, 8, 4, 4, 4, 6, 7, 8, 5, 5, 9, 1, 9, 6, 8, 3,
        0, 8, 6, 8, 3, 3, 9, 6], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 13 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([2, 2, 7, 1, 5, 9, 8, 8, 2, 2, 5, 9, 5, 4, 3, 0, 2, 7, 5, 5, 0, 4, 5, 5,
        2, 7, 2, 4, 9, 9, 5, 0, 2, 8, 0, 6, 6, 9, 5, 4, 7, 0, 4, 5, 6, 8, 0, 2,
        3, 9, 0, 0, 9, 6, 4, 2, 8, 4, 5, 2, 3, 3, 5, 3, 5, 6, 8, 4, 7, 4, 2, 8,
        3, 7, 6, 0, 3, 2, 8, 4, 8, 5, 2, 7, 8, 2, 5, 4, 9, 3, 8, 1, 3, 1, 3, 2,
        6, 3, 7, 6, 3, 5, 6, 4, 1, 0, 8, 8, 1, 1, 1, 5, 0, 9, 1, 4, 4, 2, 4, 5,
        1, 9, 5, 6, 1, 8, 6, 9], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 14 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([3, 0, 0, 5, 0, 0, 1, 0, 8, 8, 4, 3, 0, 3, 8, 2, 0, 1, 9, 9, 4, 6, 6, 2,
        4, 9, 3, 8, 1, 2, 4, 9, 2, 4, 6, 8, 5, 9, 9, 2, 5, 3, 6, 8, 5, 6, 7, 9,
        4, 7, 7, 3, 5, 9, 2, 1, 3, 3, 8, 3, 8, 3, 3, 7, 8, 7, 5, 7, 5, 7, 6, 6,
        1, 6, 6, 2, 2, 9, 2, 4, 9, 7, 9, 4, 0, 7, 1, 7, 7, 6, 3, 8, 5, 9, 7, 7,
        4, 0, 5, 7, 8, 6, 1, 0, 2, 3, 8, 3, 4, 6, 1, 2, 7, 0, 0, 8, 2, 4, 7, 5,
        3, 3, 6, 1, 1, 9, 8, 1], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 15 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([5, 3, 5, 9, 4, 6, 2, 5, 1, 0, 0, 6, 8, 8, 9, 1, 6, 9, 4, 8, 7, 7, 9, 3,
        5, 5, 7, 2, 7, 7, 3, 1, 7, 5, 8, 6, 7, 4, 9, 6, 1, 2, 9, 0, 4, 2, 3, 3,
        7, 7, 1, 2, 7, 0, 0, 3, 4, 7, 4, 7, 0, 0, 8, 1, 3, 6, 3, 2, 8, 8, 4, 8,
        4, 2, 9, 3, 8, 2, 7, 7, 6, 5, 9, 5, 6, 8, 4, 1, 3, 1, 5, 0, 2, 7, 3, 0,
        7, 7, 6, 4, 3, 9, 6, 9, 9, 6, 2, 4, 1, 6, 2, 6, 2, 7, 0, 1, 2, 4, 3, 1,
        0, 1, 4, 7, 0, 2, 0, 8], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 16 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([3, 0, 8, 5, 8, 7, 7, 7, 3, 0, 1, 8, 2, 5, 4, 1, 4, 0, 2, 8, 0, 5, 4, 5,
        6, 0, 0, 9, 0, 1, 5, 5, 1, 3, 0, 4, 7, 0, 0, 4, 1, 9, 7, 4, 1, 9, 3, 0,
        6, 9, 3, 9, 0, 4, 3, 4, 7, 6, 7, 6, 0, 8, 9, 1, 3, 7, 7, 6, 3, 7, 4, 4,
        4, 9, 8, 7, 4, 0, 9, 4, 7, 9, 5, 8, 4, 7, 2, 9, 2, 1, 2, 3, 0, 4, 8, 5,
        7, 3, 1, 0, 0, 7, 1, 6, 3, 6, 2, 8, 1, 4, 2, 4, 3, 8, 1, 9, 6, 0, 2, 3,
        3, 4, 6, 2, 3, 5, 7, 1], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 17 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([1, 1, 0, 6, 8, 2, 9, 1, 7, 6, 1, 5, 8, 6, 0, 2, 2, 9, 2, 0, 9, 5, 1, 8,
        6, 5, 4, 8, 9, 2, 1, 3, 0, 6, 3, 1, 3, 9, 5, 5, 4, 0, 1, 1, 0, 0, 6, 2,
        1, 5, 8, 0, 2, 2, 5, 3, 7, 4, 5, 8, 9, 3, 2, 4, 4, 4, 3, 6, 8, 0, 2, 9,
        4, 7, 2, 6, 1, 6, 1, 2, 0, 9, 8, 1, 2, 7, 6, 9, 0, 4, 5, 1, 6, 0, 4, 6,
        6, 2, 5, 4, 7, 0, 2, 5, 8, 4, 1, 8, 0, 8, 8, 7, 7, 3, 8, 2, 5, 5, 1, 3,
        3, 4, 2, 7, 8, 4, 4, 4], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 18 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([4, 9, 7, 0, 9, 2, 1, 2, 6, 1, 5, 2, 4, 6, 2, 8, 9, 7, 5, 0, 2, 0, 6, 5,
        8, 8, 4, 9, 2, 6, 8, 6, 1, 7, 8, 1, 7, 7, 3, 3, 6, 0, 4, 7, 3, 9, 7, 9,
        7, 3, 2, 1, 0, 6, 3, 9, 2, 3, 2, 7, 7, 2, 7, 6, 6, 8, 3, 0, 9, 6, 6, 3,
        0, 9, 2, 7, 8, 9, 0, 2, 1, 3, 7, 9, 5, 0, 4, 5, 9, 4, 7, 1, 4, 0, 0, 0,
        3, 5, 1, 4, 4, 9, 2, 9, 0, 2, 6, 3, 3, 5, 2, 9, 2, 6, 4, 7, 7, 3, 9, 6,
        6, 1, 7, 8, 8, 1, 1, 9], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 19 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([6, 9, 6, 7, 4, 3, 1, 0, 7, 0, 9, 4, 9, 9, 2, 2, 0, 8, 8, 9, 4, 3, 3, 3,
        4, 0, 2, 0, 5, 1, 0, 1, 0, 6, 0, 5, 9, 8, 0, 7, 1, 7, 3, 0, 9, 2, 9, 1,
        5, 3, 3, 1, 6, 0, 2, 6, 8, 8, 0, 6, 4, 0, 3, 2, 1, 5, 4, 7, 3, 1, 4, 2,
        0, 8, 1, 0, 9, 0, 3, 0, 3, 4, 5, 3, 3, 1, 1, 6, 6, 5, 3, 6, 8, 2, 4, 9,
        3, 1, 3, 5, 0, 9, 8, 2, 4, 9, 9, 8, 2, 8, 8, 7, 5, 8, 3, 5, 3, 1, 3, 9,
        3, 4, 6, 1, 6, 0, 9, 5], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 20 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([0, 5, 7, 0, 1, 8, 2, 4, 0, 3, 2, 2, 3, 2, 9, 3, 8, 6, 2, 5, 8, 4, 6, 0,
        5, 9, 7, 3, 1, 3, 3, 1, 9, 6, 5, 4, 7, 3, 8, 4, 5, 6, 2, 5, 4, 0, 7, 0,
        6, 8, 6, 2, 2, 6, 8, 7, 7, 8, 1, 6, 4, 2, 0, 1, 0, 6, 3, 9, 3, 8, 9, 6,
        5, 6, 0, 6, 2, 8, 7, 3, 6, 4, 6, 2, 4, 4, 5, 0, 0, 1, 8, 8, 9, 8, 6, 0,
        3, 9, 0, 4, 3, 8, 4, 7, 6, 7, 1, 4, 8, 4, 9, 3, 7, 3, 1, 6, 2, 2, 0, 3,
        0, 8, 7, 5, 1, 1, 4, 8], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 21 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([1, 5, 6, 4, 7, 3, 8, 3, 3, 4, 7, 1, 0, 1, 4, 6, 0, 2, 2, 3, 8, 0, 5, 5,
        1, 6, 7, 6, 7, 5, 3, 5, 1, 7, 5, 4, 7, 9, 3, 9, 0, 8, 2, 6, 5, 8, 9, 6,
        4, 5, 6, 4, 5, 8, 6, 3, 0, 1, 8, 8, 4, 3, 6, 7, 9, 6, 5, 8, 5, 7, 5, 6,
        7, 9, 5, 3, 9, 7, 7, 6, 2, 5, 8, 0, 6, 3, 4, 9, 7, 1, 2, 6, 3, 2, 3, 2,
        3, 7, 0, 2, 0, 7, 0, 8, 4, 8, 1, 7, 0, 3, 8, 3, 4, 3, 5, 0, 4, 9, 3, 8,
        0, 2, 4, 6, 5, 3, 4, 2], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 22 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([1, 0, 2, 6, 8, 0, 0, 4, 4, 2, 6, 5, 9, 0, 8, 6, 7, 9, 8, 2, 2, 3, 7, 0,
        0, 9, 4, 4, 5, 1, 6, 5, 8, 1, 1, 4, 1, 2, 0, 1, 0, 2, 4, 4, 5, 1, 2, 2,
        5, 6, 1, 6, 0, 5, 7, 7, 6, 1, 1, 9, 8, 9, 9, 2, 6, 0, 4, 6, 1, 3, 3, 3,
        2, 0, 0, 8, 1, 4, 0, 3, 1, 7, 7, 2, 2, 7, 5, 7, 6, 7, 2, 5, 6, 9, 3, 7,
        6, 8, 6, 8, 8, 2, 5, 5, 8, 6, 9, 7, 7, 3, 0, 1, 7, 8, 1, 7, 0, 2, 5, 5,
        0, 9, 1, 4, 0, 9, 7, 2], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 23 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
logits: tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<AddmmBackward>), y: tensor([3, 3, 9, 5, 0, 0, 7, 9, 2, 9, 3, 6, 8, 9, 3, 5, 9, 1, 3, 7, 5, 5, 1, 3,
        5, 0, 6, 0, 9, 8, 5, 9, 4, 3, 5, 7, 2, 5, 2, 2, 1, 1, 7, 0, 0, 2, 6, 9,
        9, 4, 5, 8, 0, 3, 5, 3, 4, 4, 6, 4, 0, 4, 7, 7, 2, 5, 2, 6, 6, 8, 9, 8,
        2, 4, 1, 5, 8, 4, 0, 6, 7, 6, 5, 0, 4, 0, 8, 1, 6, 9, 3, 5, 3, 2, 4, 0,
        4, 8, 7, 3, 7, 3, 1, 0, 6, 8, 0, 2, 0, 8, 0, 5, 5, 8, 2, 7, 7, 0, 1, 3,
        3, 0, 5, 2, 8, 3, 5, 6], device='cuda:0'), scale: 1.0, loss: nan, grad: nan
i: 24 penalty_anneal_iters 190 loss: nan, penalty_weight: 1.0, train_penalty: nan
